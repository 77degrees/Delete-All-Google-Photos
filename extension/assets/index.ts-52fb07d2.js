import{S as Z,i as j,s as U,h as Y,c as d,n as M,g as _,o as V,e as h,a as P,b as T,t as p,d as f,l as G,f as A,r as W}from"./index-6cab9911.js";import{E as X}from"./ExtPay.module-d5c3e8e1.js";function H(n){const e=n.slice(),t=Number(localStorage.getItem("last_deleted_at"))||new Date().getTime();e[14]=t;const l=24-Math.floor(new Date().getTime()-e[14])/1e3/60/60;return e[15]=l,e}function B(n){let e;function t(i,a){return i[3]?J:F}let l=t(n),o=l(n);return{c(){o.c(),e=Y()},m(i,a){o.m(i,a),d(i,e,a)},p(i,a){l===(l=t(i))&&o?o.p(i,a):(o.d(1),o=l(i),o&&(o.c(),o.m(e.parentNode,e)))},d(i){i&&_(e),o.d(i)}}}function F(n){let e,t,l;return{c(){e=h("div"),e.innerHTML="",t=P(),l=h("div"),l.innerHTML='<div class="status-icon svelte-3n4gvy">üîê</div><h1>Please log in first</h1><p class="svelte-3n4gvy"><a href="https://photos.google.com/login?delete_all">Log in to your Google account</a> to start deleting Google Photos.</p><p class="svelte-3n4gvy" style="font-size:0.85rem;color:#5f6368;">Note: This extension does not record or transmit any of your private data. It simply automates the process of deleting.</p>',T(e,"class","unclickable svelte-3n4gvy"),T(l,"class","overlay svelte-3n4gvy")},m(o,i){d(o,e,i),d(o,t,i),d(o,l,i)},p:M,d(o){o&&(_(e),_(t),_(l))}}}function J(n){let e,t,l;function o(u,m){if(u[5])return ee;if(u[6])return $;if(!u[4]&&!u[0])return x;if(!u[0])return Q;if(u[0])return K}let i=o(n),a=i&&i(n);return{c(){e=h("div"),e.innerHTML="",t=P(),l=h("div"),a&&a.c(),T(e,"class","unclickable svelte-3n4gvy"),T(l,"class","overlay svelte-3n4gvy")},m(u,m){d(u,e,m),d(u,t,m),d(u,l,m),a&&a.m(l,null)},p(u,m){i===(i=o(u))&&a?a.p(u,m):(a&&a.d(1),a=i&&i(u),a&&(a.c(),a.m(l,null)))},d(u){u&&(_(e),_(t),_(l)),a&&a.d()}}}function K(n){var g;let e,t,l,o,i,a,u,m,b,w,v,S,D,I,k,y;return{c(){e=h("div"),e.innerHTML='<div class="status-icon svelte-3n4gvy">‚úÖ</div>',t=h("h1"),l=p("Success!"),o=P(),i=h("div"),i.setAttribute("class","progress-container svelte-3n4gvy"),a=h("div"),a.setAttribute("class","progress-count svelte-3n4gvy"),a.textContent=n[2]+" photos moved to trash",u=P(),m=h("p"),m.setAttribute("class","svelte-3n4gvy"),b=p("From account: "),w=h("b"),w.textContent=n[3],v=P(),S=h("p"),S.setAttribute("class","svelte-3n4gvy"),D=p("Go to "),I=h("a"),I.textContent="Google Photos Trash",k=p(' and click "Empty trash" to permanently delete all photos.'),T(I,"href",n[8]),T(I,"style","color:#1a73e8;font-weight:600;")},m(s,c){d(s,e,c),d(s,t,c),f(t,l),d(s,o,c),d(s,i,c),f(i,a),d(s,u,c),d(s,m,c),f(m,b),f(m,w),d(s,v,c),d(s,S,c),f(S,D),f(S,I),f(S,k),y||(y=G(I,"click",n[10]))},p(s,c){c&4&&(a.textContent=s[2]+" photos moved to trash"),c&8&&(w.textContent=s[3]),c&256&&T(I,"href",s[8])},d(s){s&&(_(e),_(t),_(o),_(i),_(u),_(m),_(v),_(S)),y=!1}}}function Q(n){let e,t,l,o,i,pc,pb,ps,pv;const nd=Number(localStorage.getItem("num_deleted"))||0;return{c(){e=h("div"),e.innerHTML='<div class="status-icon svelte-3n4gvy">üóëÔ∏è</div>',t=h("h1"),t.textContent="Deleting photos...",l=P(),pc=h("div"),pc.setAttribute("class","progress-container svelte-3n4gvy"),pb=h("div"),pb.setAttribute("class","progress-bar-wrapper svelte-3n4gvy"),pb.innerHTML='<div class="progress-bar svelte-3n4gvy" style="width:50%;animation:pulse 2s infinite;"></div>',ps=h("div"),ps.setAttribute("class","progress-stats svelte-3n4gvy"),pv=h("span"),pv.setAttribute("class","progress-count svelte-3n4gvy"),pv.textContent=nd.toLocaleString()+" deleted so far",ps.appendChild(pv),pc.appendChild(pb),pc.appendChild(ps),o=P(),i=h("p"),i.textContent="Please leave this page open. Don't click anything or close this tab. The deletion process will continue automatically. You can resume from the extension popup if interrupted.",T(i,"class","svelte-3n4gvy"),T(i,"style","font-size:0.9rem;")},m(s,c){d(s,e,c),d(s,t,c),d(s,l,c),d(s,pc,c),d(s,o,c),d(s,i,c)},p:M,d(s){s&&(_(e),_(t),_(l),_(pc),_(o),_(i))}}}function x(n){let e,t,l,o,i,a,u,m,b,w,v,S,D,I,k,y,r,g;return{c(){e=h("div"),e.innerHTML='<div class="status-icon svelte-3n4gvy">‚ö†Ô∏è</div>',t=h("h1"),t.textContent="Confirm Deletion",l=P(),o=h("p"),o.setAttribute("class","svelte-3n4gvy"),i=p("You are about to delete "),a=h("strong"),a.textContent=n[2],u=p(" photos from account "),m=h("b"),m.textContent=n[3],b=P(),w=h("div"),w.setAttribute("style","margin-top:20px;"),v=h("button"),S=p("‚úì Yes, delete "),D=p(n[2]),I=p(" photos"),k=P(),y=h("button"),y.textContent="‚Üª Try another account",r=P(),g=h("button"),g.textContent="‚úï Cancel"},m(s,c){d(s,e,c),d(s,t,c),d(s,l,c),d(s,o,c),f(o,i),f(o,a),f(o,u),f(o,m),d(s,b,c),d(s,w,c),f(w,v),f(v,S),f(v,D),f(v,I),f(w,k),f(w,y),f(w,r),f(w,g),G(v,"click",n[9]),G(y,"click",oe),G(g,"click",n[10])},p(s,c){c&4&&(a.textContent=s[2]),c&8&&(m.textContent=s[3]),c&4&&A(D,s[2])},d(s){s&&(_(e),_(t),_(l),_(o),_(b),_(w))}}}function $(n){let e;return{c(){e=h("div"),e.innerHTML='<div class="status-icon svelte-3n4gvy">‚ùå</div><h1>Network Error</h1><p class="svelte-3n4gvy">There was a network error. Please reload this page to try again.</p><button onclick="location.reload()">‚Üª Reload Page</button>'},m(t,l){d(t,e,l)},p:M,d(t){t&&_(e)}}}function ee(n){let e;return{c(){e=h("div"),e.innerHTML='<div class="status-icon svelte-3n4gvy">‚è≥</div><h1>Loading...</h1><p class="svelte-3n4gvy">Please wait while we prepare the deletion process.</p>'},m(t,l){d(t,e,l)},p:M,d(t){t&&_(e)}}}function z(n){let e,t,l,o,i=Math.round(n[15])+"",a,u,m=n[15]>1?"s":"",b,w,v,S,D,I;return{c(){e=h("p"),t=p("You can delete "),l=p(n[2]),o=p(" more comments in "),a=p(i),u=p(" hour"),b=p(m),w=p(" or delete all now by "),v=h("a"),v.textContent="upgrading with a small one-time payment",S=p("."),T(v,"href","#null"),T(e,"class","svelte-3n4gvy")},m(k,y){d(k,e,y),f(e,t),f(e,l),f(e,o),f(e,a),f(e,u),f(e,b),f(e,w),f(e,v),f(e,S),D||(I=G(v,"click",n[11]),D=!0)},p(k,y){y&4&&A(l,k[2])},d(k){k&&_(e),D=!1,I()}}}function te(n){let e,t=!n[7]&&B(n);return{c(){t&&t.c(),e=Y()},m(l,o){t&&t.m(l,o),d(l,e,o)},p(l,[o]){l[7]?t&&(t.d(1),t=null):t?t.p(l,o):(t=B(l),t.c(),t.m(e.parentNode,e))},i:M,o:M,d(l){l&&_(e),t&&t.d(l)}}}const R=1e3,q=Number.MAX_SAFE_INTEGER;function E(n){return new Promise(e=>setTimeout(e,n))}async function O(n,e){const t=new Date;for(;!document.querySelector(n);){if(new Date-t>=e*1e3)return null;await E(50)}return document.querySelector(n)}function oe(n){n.preventDefault();const t=document.querySelector('a[href^="https://accounts.google.com/SignOutOptions"]').getAttribute("href");window.location.href=t}function le(n,e,t){const l=X("delete-all-google-photos");let o,i="all",a="",u=!1,m=!1,b=!0,w=!1;V(async()=>{var N,L;const r=/^.*(:|Ôºö|Compte Google)\s/;t(3,a=(L=(N=document.querySelector('a[aria-label][href^="https://accounts.google.com/SignOutOptions"]'))==null?void 0:N.getAttribute("aria-label").split(r)[2])==null?void 0:L.split(",")[0]);try{t(1,o=await l.getUser())}catch{t(6,w=!0)}t(5,b=!1);t(2,i="all")}),l.onPaid.addListener(r=>{window.location.reload()});async function v(r){var C;let g=0;if((C=document.querySelector('a[href^="https://itunes.apple.com/app/apple-store/id962194608"]'))!=null&&C.offsetParent)return 0;document.querySelector('c-wiz[role="main"]').scrollBy(0,500),await E(500);let s=10;for(;g<R;){const N=document.querySelectorAll('div[role="checkbox"][aria-checked="false"][jsaction^="mousedown"');if(N.length>0){for(var c=0;c<N.length;++c){if(g>=R)return g;g+=1,N[c].click()}N[N.length-1].scrollIntoView(),s=10}else if(s>0)console.log("retry count",s),document.querySelector('c-wiz[role="main"]').scrollBy(0,1e3),s-=1,await E(500);else return g;await E(300)}return g}async function S(){t(4,u=!0);let r=Number(localStorage.getItem("num_deleted"));for(;;){let g=await v(r);if(g==0){t(0,m=!0);return}console.log("clicking delete button",new Date),(await O("div[data-delete-origin] button",1)).click(),console.log('waiting for "got it" button',new Date);const c=await O('div[role="dialog"] button[autofocus]',.5);c&&(console.log('clicking "got it" button',new Date),c.click()),console.log('waiting for "move to trash" button',new Date);const C=await O("button[data-mdc-dialog-button-default]",30);C&&(console.log('clicking "move to trash" button',new Date),C.click());const N=await O("aside button[aria-label][data-use-native-focus-logic]",5*60);N&&(console.log('clicking close button on tooltip saying "N moved to trash"',new Date),N.click(),r+=g,localStorage.setItem("num_deleted",r),localStorage.setItem("last_deleted_at",new Date().getTime()),updateProgressDisplay(r))}}function updateProgressDisplay(count){const el=document.querySelector('.progress-count.svelte-3n4gvy');if(el)el.textContent=count.toLocaleString()+' deleted so far'}let D=!1;function I(r){t(7,D=!0)}async function k(r){r.preventDefault(),await l.openPaymentPage(),setTimeout(function(){chrome.runtime.sendMessage({closeTab:!0})},3e3)}let y=window.location.href.split("?")[0];return y.endsWith("/")||(y+="/"),y+="trash",n.$$.update=()=>{n.$$.dirty&1&&m&&(document.title="‚úÖ Done! "+document.title)},[m,o,i,a,u,b,w,D,y,S,I,k]}class ne extends Z{constructor(e){super(),j(this,e,le,te,U,{})}}new ne({target:document.body});
